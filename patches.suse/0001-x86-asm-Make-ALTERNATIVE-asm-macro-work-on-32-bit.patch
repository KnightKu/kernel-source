From 1074475147669f63c84339da57bbdf62bf1a4bfb Mon Sep 17 00:00:00 2001
From: Joerg Roedel <jroedel@suse.de>
Date: Tue, 13 Mar 2018 15:07:10 +0100
Subject: [PATCH 01/17] x86/asm: Make ALTERNATIVE asm-macro work on 32 bit
References: bsc#1068032 CVE-2017-5754
Patch-mainline: No, different upstream implementation

The struct has a different layout on 32 bit. Use the proper
defines to make it work on 32 and 64 bit.

Signed-off-by: Joerg Roedel <jroedel@suse.de>
---
 arch/x86/include/asm/alternative-asm.h | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

--- a/arch/x86/include/asm/alternative-asm.h
+++ b/arch/x86/include/asm/alternative-asm.h
@@ -19,9 +19,9 @@
 #endif
 
 .macro altinstruction_entry orig alt feature orig_len alt_len
-	.align 8
-	.quad \orig
-	.quad \alt
+	_ASM_ALIGN
+	_ASM_PTR \orig
+	_ASM_PTR \alt
 	.word \feature
 	.byte \orig_len
 	.byte \alt_len
