From e2b702eeeb36d16c8ef694b4947a3f19e1758b33 Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oneukum@suse.de>
Date: Tue, 15 Mar 2016 15:19:30 +0100
Subject: [PATCH] wacom: fix crash due to missing endpoint
Patch-Mainline: Never (upstream not vulnerable)
References: bnc#970909, CVE-2016-3139

We need to bail out if the endpoint we need is not present.

Signed-off-by: Oliver Neukum <oneukum@suse.com>
---
 drivers/input/tablet/wacom_sys.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/drivers/input/tablet/wacom_sys.c b/drivers/input/tablet/wacom_sys.c
index 449c0a4..79cb8f4 100644
--- a/drivers/input/tablet/wacom_sys.c
+++ b/drivers/input/tablet/wacom_sys.c
@@ -515,6 +515,10 @@ static int wacom_probe(struct usb_interface *intf, const struct usb_device_id *i
 	wacom_wac->input = input_dev;
 
 	endpoint = &intf->cur_altsetting->endpoint[0].desc;
+	if (!endpoint) {
+		error = -ENODEV;
+		goto fail3;
+	}
 
 	/* Retrieve the physical and logical size for OEM devices */
 	error = wacom_retrieve_hid_descriptor(intf, features);
-- 
2.1.4

