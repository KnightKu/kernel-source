From: Johannes Thumshirn <jthumshirn@suse.de>
Date: Mon 14 May 10:36:57 CEST 2018
Subject: KABI protect struct _lowcore
References: bsc#1089386
Patch-mainline: Never, KABI patch

KABI protect struct _lowcore

Signed-off-by: Johannes Thumshirn <jthumshirn@suse.de>
---
 arch/s390/include/asm/lowcore.h |   14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

--- a/arch/s390/include/asm/lowcore.h
+++ b/arch/s390/include/asm/lowcore.h
@@ -161,9 +161,13 @@ struct _lowcore {
 	__u32	os_info;			/* 0x0e18 */
 	__u8	pad_0x0e1c[0x0f00-0x0e1c];	/* 0x0e1c */
 
+#ifndef __GENKSYMS__
 	/* Extended facility list */
 	__u64	stfle_fac_list[16];		/* 0x0f00 */
 	__u64	alt_stfle_fac_list[16];		/* 0x0f80 */
+#else
+	__u64	stfle_fac_list[32];		/* 0x0f00 */
+#endif
 } __packed;
 
 #else /* CONFIG_32BIT */
@@ -290,13 +294,13 @@ struct _lowcore {
 #ifndef __GENKSYMS__
 	__u32	spinlock_lockval;		/* 0x0400 */
 	__u8	pad_0x0404[0x0500-0x0404];	/* 0x0404 */
-#else
-	__u8	pad_0x0400[0x0500-0x0400];	/* 0x0400 */
-#endif
 
 	/* br %r1 trampoline */
 	__u16	br_r1_trampoline;		/* 0x0500 */
 	__u8	pad_0x0502[0x0e00-0x0502];	/* 0x0502 */
+#else
+	__u8	pad_0x0400[0x0e00-0x0400];	/* 0x0400 */
+#endif
 
 	/*
 	 * 0xe00 contains the address of the IPL Parameter Information
@@ -316,8 +320,12 @@ struct _lowcore {
 	__u8	pad_0x0e20[0x0f00-0x0e20];	/* 0x0e20 */
 
 	/* Extended facility list */
+#ifndef __GENKSYMS__
 	__u64	stfle_fac_list[16];		/* 0x0f00 */
 	__u64	alt_stfle_fac_list[16];		/* 0x0f80 */
+#else
+	__u64	stfle_fac_list[32];		/* 0x0f00 */
+#endif
 	__u8	pad_0x1000[0x11b8-0x1000];	/* 0x1000 */
 
 	/* 64 bit extparam used for pfault/diag 250: defined by architecture */
