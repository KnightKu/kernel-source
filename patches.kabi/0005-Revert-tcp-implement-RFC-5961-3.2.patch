From: Jiri Bohac <jbohac@suse.cz>
Subject: Revert "tcp: implement RFC 5961 3.2"
Patch-mainline: never, kABI
References: bsc#969340, CVE-2004-0230

This reverts parts of commit 86791bbfe5ed7b275be040cfeff049a1624af1b7
(upstream commit 282f23c6ee343126156dd41218b22ece96d747e3). 

The functional parts  of the fix are preserved and only the parts 
adding new statistics are removed since they 
change public SNMP interface indices.

Signed-off-by: Jiri Bohac <jbohac@suse.cz>
---
 include/linux/snmp.h |    1 -
 net/ipv4/proc.c      |    1 -
 net/ipv4/tcp_input.c |    1 -
 3 files changed, 3 deletions(-)

--- a/include/linux/snmp.h
+++ b/include/linux/snmp.h
@@ -231,7 +231,6 @@ enum
 	LINUX_MIB_TCPDEFERACCEPTDROP,
 	LINUX_MIB_IPRPFILTER, /* IP Reverse Path Filter (rp_filter) */
 	LINUX_MIB_TCPTIMEWAITOVERFLOW,		/* TCPTimeWaitOverflow */
-	LINUX_MIB_TCPCHALLENGEACK,		/* TCPChallengeACK */
 	__LINUX_MIB_MAX
 };
 
--- a/net/ipv4/proc.c
+++ b/net/ipv4/proc.c
@@ -254,7 +254,6 @@ static const struct snmp_mib snmp4_net_l
 	SNMP_MIB_ITEM("TCPDeferAcceptDrop", LINUX_MIB_TCPDEFERACCEPTDROP),
 	SNMP_MIB_ITEM("IPReversePathFilter", LINUX_MIB_IPRPFILTER),
 	SNMP_MIB_ITEM("TCPTimeWaitOverflow", LINUX_MIB_TCPTIMEWAITOVERFLOW),
-	SNMP_MIB_ITEM("TCPChallengeACK", LINUX_MIB_TCPCHALLENGEACK),
 	SNMP_MIB_SENTINEL
 };
 
--- a/net/ipv4/tcp_input.c
+++ b/net/ipv4/tcp_input.c
@@ -3652,7 +3652,6 @@ static void tcp_send_challenge_ack(struc
 		challenge_count = 0;
 	}
 	if (++challenge_count <= sysctl_tcp_challenge_ack_limit) {
-		NET_INC_STATS_BH(sock_net(sk), LINUX_MIB_TCPCHALLENGEACK);
 		tcp_send_ack(sk);
 	}
 }
