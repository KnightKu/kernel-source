From: Don Brace <don.brace@microsemi.com>
Date: Fri, 7 Apr 2017 15:06:15 -0500
Subject: hpsa: rescan later if reset in progress
Patch-mainline: Submitted, 2017-04-07, linux-scsi
References: bsc#1022600 fate#321928

 - schedule another scan.
 - mark current scan as completed

Reviewed-by: Scott Benesh <scott.benesh@microsemi.com>
Reviewed-by: Scott Teel <scott.teel@microsemi.com>
Reviewed-by: Kevin Barnett <kevin.barnett@microsemi.com>
Signed-off-by: Don Brace <don.brace@microsemi.com>
Acked-by: Martin Wilck <mwilck@suse.com>
---
 drivers/scsi/hpsa.c |    1 +
 1 file changed, 1 insertion(+)

--- a/drivers/scsi/hpsa.c
+++ b/drivers/scsi/hpsa.c
@@ -5631,6 +5631,7 @@ static void hpsa_scan_start(struct Scsi_
 	 */
 	if (h->reset_in_progress) {
 		h->drv_req_rescan = 1;
+		hpsa_scan_complete(h);
 		return;
 	}
 
