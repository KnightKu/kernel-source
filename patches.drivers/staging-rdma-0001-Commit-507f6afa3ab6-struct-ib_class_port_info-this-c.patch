From 3197b5bb96c55c0d0b3acdd958ca764434d7ac79 Mon Sep 17 00:00:00 2001
From: Thomas Bogendoerfer <tbogendoerfer@suse.de>
Date: Thu, 23 Mar 2017 14:34:27 +0100
Subject: Commit 507f6afa3ab6 struct ib_class_port_info; this commit fixes
 staging/rdma drivers
References: bsc#1030230
Patch-mainline: Never, fixes build bugs in upstream removed Linux drivers

Signed-off-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/staging/rdma/ehca/ehca_sqp.c   | 2 +-
 drivers/staging/rdma/ipath/ipath_mad.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/staging/rdma/ehca/ehca_sqp.c b/drivers/staging/rdma/ehca/ehca_sqp.c
index 376b031c2c7f..0a7ccac5ab03 100644
--- a/drivers/staging/rdma/ehca/ehca_sqp.c
+++ b/drivers/staging/rdma/ehca/ehca_sqp.c
@@ -173,7 +173,7 @@ static int ehca_process_perf(struct ib_device *ibdev, u8 port_num,
 		memset(poi, 0, sizeof(*poi));
 		poi->base_version = 1;
 		poi->class_version = 1;
-		poi->resp_time_value = 18;
+		ib_set_cpi_resp_time(poi, 18);
 
 		/* copy local routing information from WC where applicable */
 		tcslfl->sl         = in_wc->sl;
diff --git a/drivers/staging/rdma/ipath/ipath_mad.c b/drivers/staging/rdma/ipath/ipath_mad.c
index ad3a926ab3c5..f3251b6f018f 100644
--- a/drivers/staging/rdma/ipath/ipath_mad.c
+++ b/drivers/staging/rdma/ipath/ipath_mad.c
@@ -814,7 +814,7 @@ static int recv_pma_get_classportinfo(struct ib_pma_mad *pmp)
 	 * Expected response time is 4.096 usec. * 2^18 == 1.073741824
 	 * sec.
 	 */
-	p->resp_time_value = 18;
+	ib_set_cpi_resp_time(p, 18);
 
 	return reply((struct ib_smp *) pmp);
 }
-- 
1.8.5.6

