From: Adheer Chandravanshi <adheer.chandravanshi@qlogic.com>
Date: Mon, 1 Jul 2013 05:54:12 -0400
Subject: [SCSI] libiscsi: Exporting new attrs for iscsi session and
	connection in sysfs
Git-commit: f8525eb4cff0c5df5b513a5f30ffebcda43460bb
Patch-mainline: v3.12-rc1
References: bsc#923002

lduncan@suse.com:
Partial backport, since we only needed the discovery session, and
did not want to port unused code in order to keep the patch intact.

Signed-off-by: Adheer Chandravanshi <adheer.chandravanshi@qlogic.com>
Signed-off-by: Vikas Chaudhary <vikas.chaudhary@qlogic.com>
Reviewed-by: Mike Christie <michaelc@cs.wisc.edu>
Signed-off-by: James Bottomley <JBottomley@Parallels.com>
Acked-by: Lee Duncan <lduncan@suse.com>
---
 drivers/scsi/libiscsi.c |    3 +++
 include/scsi/libiscsi.h |    2 ++
 2 files changed, 5 insertions(+)

--- a/drivers/scsi/libiscsi.c
+++ b/drivers/scsi/libiscsi.c
@@ -3326,6 +3326,9 @@ int iscsi_session_get_param(struct iscsi
 	case ISCSI_PARAM_INITIATOR_NAME:
 		len = sprintf(buf, "%s\n", session->initiatorname);
 		break;
+	case ISCSI_PARAM_DISCOVERY_SESS:
+		len = sprintf(buf, "%u\n", session->discovery_sess);
+		break;
 	default:
 		return -ENOSYS;
 	}
--- a/include/scsi/libiscsi.h
+++ b/include/scsi/libiscsi.h
@@ -287,6 +287,8 @@ struct iscsi_session {
 	char			*targetalias;
 	char			*ifacename;
 	char			*initiatorname;
+	char			*discovery_sess;
+
 	/* control data */
 	struct iscsi_transport	*tt;
 	struct Scsi_Host	*host;
