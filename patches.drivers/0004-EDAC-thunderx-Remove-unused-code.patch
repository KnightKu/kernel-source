From 293078417ad695106021daca3e1a2734720553ad Mon Sep 17 00:00:00 2001
From: Sergey Temerkhanov <s.temerkhanov@gmail.com>
Date: Thu, 6 Apr 2017 11:38:34 +0000
Subject: [PATCH 4/4] EDAC, thunderx: Remove unused code

Git-commit: 5195c206fda39a10d946505d95ec653e2b83a8ab
Patch-mainline: v4.12-rc1
References: bsc#1035479

Remove unused code reserved for upcoming CPUs.

Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
Signed-off-by: Sergey Temerkhanov <s.temerkhanov@gmail.com>
Cc: David Daney <david.daney@cavium.com>
Cc: Jan.Glauber@cavium.com
Cc: linux-edac <linux-edac@vger.kernel.org>
Link: http://lkml.kernel.org/r/20170406113834.17153-1-s.temerkhanov@gmail.com
Signed-off-by: Borislav Petkov <bp@suse.de>
Signed-off-by: Mian Yousaf Kaukab <yousaf.kaukab@suse.com>
---
 drivers/edac/thunderx_edac.c | 13 ++-----------
 1 file changed, 2 insertions(+), 11 deletions(-)

diff --git a/drivers/edac/thunderx_edac.c b/drivers/edac/thunderx_edac.c
index 955f73c..86d585c 100644
--- a/drivers/edac/thunderx_edac.c
+++ b/drivers/edac/thunderx_edac.c
@@ -864,8 +864,6 @@ static struct pci_driver thunderx_lmc_driver = {
 #define OCX_COM_WIN_REQ_TOUT		BIT(50)
 #define OCX_COM_RX_LANE			GENMASK(23, 0)
 
-#define OCX_COM_INT_UE			(0)
-
 #define OCX_COM_INT_CE			(OCX_COM_IO_BADID      | \
 					 OCX_COM_MEM_BADID     | \
 					 OCX_COM_COPR_BADID    | \
@@ -1175,9 +1173,7 @@ static irqreturn_t thunderx_ocx_com_threaded_isr(int irq, void *irq_id)
 				strncat(msg, other, OCX_MESSAGE_SIZE);
 			}
 
-		if (ctx->reg_com_int & OCX_COM_INT_UE)
-			edac_device_handle_ue(ocx->edac_dev, 0, 0, msg);
-		else if (ctx->reg_com_int & OCX_COM_INT_CE)
+		if (ctx->reg_com_int & OCX_COM_INT_CE)
 			edac_device_handle_ce(ocx->edac_dev, 0, 0, msg);
 
 		ocx->com_ring_tail++;
@@ -1645,14 +1641,12 @@ static const struct error_descr l2_tad_errors[] = {
 
 #define L2C_TAD_INT_RTG		(L2C_TAD_INT_RTGDBE)
 
-#define L2C_TAD_INT_NXM		(0)
-
 #define L2C_TAD_INT_DISLMC	(L2C_TAD_INT_WRDISLMC | L2C_TAD_INT_RDDISLMC)
 
 #define L2C_TAD_INT_DISOCI	(L2C_TAD_INT_WRDISOCI | L2C_TAD_INT_RDDISOCI)
 
 #define L2C_TAD_INT_ENA_ALL	(L2C_TAD_INT_ECC | L2C_TAD_INT_TAG | \
-				 L2C_TAD_INT_RTG | L2C_TAD_INT_NXM | \
+				 L2C_TAD_INT_RTG | \
 				 L2C_TAD_INT_DISLMC | L2C_TAD_INT_DISOCI | \
 				 L2C_TAD_INT_LFBTO)
 
@@ -1803,9 +1797,6 @@ static irqreturn_t thunderx_l2c_tad_isr(int irq, void *irq_id)
 	} else if (ctx->reg_int & L2C_TAD_INT_TAG) {
 		ctx->reg_ext_name = "TTG_ERR";
 		ctx->reg_ext = readq(tad->regs + L2C_TAD_TTG_ERR);
-	} else if (ctx->reg_int & L2C_TAD_INT_NXM) {
-		ctx->reg_ext_name = "ERR";
-		ctx->reg_ext = readq(tad->regs + L2C_TAD_ERR);
 	} else if (ctx->reg_int & L2C_TAD_INT_LFBTO) {
 		ctx->reg_ext_name = "TIMEOUT";
 		ctx->reg_ext = readq(tad->regs + L2C_TAD_TIMEOUT);
-- 
2.11.0

