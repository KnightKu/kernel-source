From: Peter Chen <peter.chen@nxp.com>
Date: Mon, 1 Aug 2016 15:02:37 +0800
Subject: ethernet: marvell: mvpp2: add missing of_node_put after calling
 of_parse_phandle
Patch-mainline: v4.8-rc1
Git-commit: ccb80393c484b071ec74b2f4ce9ef8d975fa4aa5
References: bsc#1032150

of_node_put needs to be called when the device node which is got
from of_parse_phandle has finished using.

Signed-off-by: Peter Chen <peter.chen@nxp.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Benjamin Poirier <bpoirier@suse.com>
---
 drivers/net/ethernet/marvell/mvpp2.c |    2 ++
 1 file changed, 2 insertions(+)

--- a/drivers/net/ethernet/marvell/mvpp2.c
+++ b/drivers/net/ethernet/marvell/mvpp2.c
@@ -6235,6 +6235,7 @@ err_free_stats:
 err_free_irq:
 	irq_dispose_mapping(port->irq);
 err_free_netdev:
+	of_node_put(phy_node);
 	free_netdev(dev);
 	return err;
 }
@@ -6245,6 +6246,7 @@ static void mvpp2_port_remove(struct mvp
 	int i;
 
 	unregister_netdev(port->dev);
+	of_node_put(port->phy_node);
 	free_percpu(port->pcpu);
 	free_percpu(port->stats);
 	for (i = 0; i < txq_number; i++)
