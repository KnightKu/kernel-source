From: Thomas Bogendoerfer <tbogendoerfer@suse.de>
Date: Tue, 11 Apr 2017 13:03:11 +0200
Subject: Fix changed get_user_pages() arguments
References: bsc#1030230
Patch-mainline: Never, fixes build bugs in upstream removed Linux drivers

Signed-off-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/staging/rdma/ipath/ipath_user_pages.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/drivers/staging/rdma/ipath/ipath_user_pages.c b/drivers/staging/rdma/ipath/ipath_user_pages.c
index d29b4daf61f8..401b6bf08ffa 100644
--- a/drivers/staging/rdma/ipath/ipath_user_pages.c
+++ b/drivers/staging/rdma/ipath/ipath_user_pages.c
@@ -70,9 +70,8 @@ static int __ipath_get_user_pages(unsigned long start_page, size_t num_pages,
 		   (unsigned long) num_pages, start_page);
 
 	for (got = 0; got < num_pages; got += ret) {
-		ret = get_user_pages(current, current->mm,
-				     start_page + got * PAGE_SIZE,
-				     num_pages - got, 1, 1,
+		ret = get_user_pages(start_page + got * PAGE_SIZE,
+				     num_pages - got, FOLL_WRITE | FOLL_FORCE,
 				     p + got, NULL);
 		if (ret < 0)
 			goto bail_release;
-- 
1.8.5.6

